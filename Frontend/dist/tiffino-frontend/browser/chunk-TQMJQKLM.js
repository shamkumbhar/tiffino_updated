import{a as U}from"./chunk-4FKSEUSB.js";import{c as j,e as b,f as z,h as N}from"./chunk-BZFQF35X.js";import{b as F,c as u,d as R,e as V,g as K,j as q,m as D,r as G,t as H}from"./chunk-2JJLSGUY.js";import{b as T}from"./chunk-C7KO63XU.js";import{$a as x,B as w,Da as l,Ea as p,Nb as I,P as C,Pb as O,S as y,Sa as c,Ua as s,X as S,Xa as i,Ya as n,Za as d,_a as L,ab as g,ba as k,eb as a,fb as P,ka as E,la as M,ma as h,na as v,nb as A,q as _}from"./chunk-S2EL3J7Q.js";var B=(()=>{class t{constructor(e){this.http=e,this.adminKey="adminUser",this.tokenKey="adminToken",this.adminLoginUrl="/users/admin/login"}adminLogin(e){return this.http.post(this.adminLoginUrl,e).pipe(C({next:o=>{let r=o.user,f=o.token;if(console.log("Admin login response:",o),r.role?.toUpperCase()!=="ADMIN")throw new Error("Not an admin account");this.setAdminToLocalStorage(r),this.setAdminToken(f)},error:o=>{console.error("Admin login failed:",o.error||o)}}),w(o=>_(()=>o)))}setAdminToLocalStorage(e){localStorage.setItem(this.adminKey,JSON.stringify(e))}setAdminToken(e){localStorage.setItem(this.tokenKey,e)}getAdminFromLocalStorage(){let e=localStorage.getItem(this.adminKey);return e?JSON.parse(e):null}getAdminToken(){return localStorage.getItem(this.tokenKey)}logoutAdmin(){localStorage.removeItem(this.adminKey),localStorage.removeItem(this.tokenKey),console.log("Admin logged out successfully.")}static{this.\u0275fac=function(o){return new(o||t)(S(T))}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Y(t,m){t&1&&(i(0,"p"),a(1,"Email is required"),n())}function Z(t,m){t&1&&(i(0,"p"),a(1,"Enter a valid email"),n())}function $(t,m){if(t&1&&(i(0,"div",23),c(1,Y,2,0,"p",24)(2,Z,2,0,"p",24),n()),t&2){let e=g();l(),s("ngIf",e.f.Email.errors==null?null:e.f.Email.errors.required),l(),s("ngIf",e.f.Email.errors==null?null:e.f.Email.errors.email)}}function ee(t,m){t&1&&(i(0,"p"),a(1,"Email is required"),n())}function te(t,m){if(t&1&&(i(0,"div",23),c(1,ee,2,0,"p",24),n()),t&2){let e=g();l(),s("ngIf",e.f.password.errors==null?null:e.f.password.errors.required)}}function ie(t,m){t&1&&(i(0,"div",25),d(1,"div",26),n())}function ne(t,m){t&1&&(i(0,"div",27)(1,"div",28)(2,"div",29),d(3,"img",30),n(),i(4,"h4",31),a(5,"Login Successful"),n(),i(6,"h4")(7,"a",32),a(8,"Delivery agents"),n()()()())}function oe(t,m){if(t&1){let e=L();i(0,"div",33)(1,"div",34)(2,"div",35),h(),i(3,"svg",36),d(4,"path",37),n()(),v(),i(5,"h4"),a(6,"Login Failed"),n(),i(7,"p"),a(8),n(),i(9,"button",38),x("click",function(){E(e);let r=g();return M(r.showErrorPopup=!1)}),a(10,"Close"),n()()()}if(t&2){let e=g();l(8),P(e.errorMessage)}}var ue=(()=>{class t{constructor(e,o,r,f,J,Q){this.adminservice=e,this.route=o,this.fb=r,this.registerservice=f,this.router=J,this.activated=Q,this.isloading=!1,this.showpopup=!1,this.errorMessage="",this.showErrorPopup=!1}ngOnInit(){this.adminform=this.fb.group({Email:["",[u.required,u.email]],password:["",[u.required]]})}get f(){return this.adminform.controls}onSubmit(){if(this.errorMessage="",this.showErrorPopup=!1,this.adminform.valid){let e=this.adminform.value,o={email:e.Email,password:e.password};this.isloading=!0,this.adminservice.adminLogin(o).subscribe({next:r=>{this.isloading=!1,this.showpopup=!0,setTimeout(()=>{this.showpopup=!1,this.router.navigate(["/delivery"])},3e3)},error:r=>{this.isloading=!1,this.errorMessage=r?.error?.message||"Admin Login failed Please Try Again Later",this.showErrorPopup=!0,console.log(r)}})}this.adminform.reset()}static{this.\u0275fac=function(o){return new(o||t)(p(B),p(b),p(G),p(U),p(b),p(j))}}static{this.\u0275cmp=k({type:t,selectors:[["app-admin-login"]],standalone:!0,features:[A],decls:35,vars:6,consts:[[1,"back"],["autoplay","","muted","","loop","","playsinline",""],["src","assets/videos/video-admin.mp4","type","video/mp4"],[1,"login-container"],[1,"login-card"],[1,"back-arrow"],["xmlns","http://www.w3.org/2000/svg","width","40","height","40","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-arrow-left"],["fill-rule","evenodd","d","M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"],[3,"ngSubmit","formGroup"],[1,"mb-2"],["for","username",1,"form-label","text-start","d-block","text-dark","h4"],["type","email","id","username","formControlName","Email","placeholder","username",1,"form-control"],["class","error",4,"ngIf"],[1,"password-container","mt-3"],["for","password",1,"form-label","text-start","d-block","text-dark","h4"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"links","mt-4"],["routerLink","/Account-Registration"],["routerLink","/forgate-password"],["type","submit",1,"login-button"],["class","spinner-overlay",4,"ngIf"],["class","popup-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],[1,"error"],[4,"ngIf"],[1,"spinner-overlay"],[1,"spinner"],[1,"popup-overlay"],[1,"popup-card"],[1,"popup-icon"],["src","assets/images/check.png","alt","imgsri",2,"width","40px","height","40px"],[1,"h3","fs-1"],["routerLink","/delivery",1,"btn","btn-primary"],[1,"error-overlay"],[1,"error-card"],[1,"error-icon"],["xmlns","http://www.w3.org/2000/svg","width","40","height","40","fill","red","viewBox","0 0 16 16",1,"bi","bi-x-circle"],["d","M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"],[1,"btn","btn-danger","w-25","mt-3",3,"click"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"video",1),d(2,"source",2),n(),i(3,"div",3)(4,"div",4)(5,"h2"),a(6,"Admin Login"),n(),i(7,"div",5),h(),i(8,"svg",6),d(9,"path",7),n()(),v(),i(10,"form",8),x("ngSubmit",function(){return r.onSubmit()}),i(11,"div",9)(12,"label",10),a(13,"Username:"),n(),d(14,"input",11),c(15,$,3,2,"div",12),n(),i(16,"div",13)(17,"label",14),a(18,"Password:"),n(),d(19,"input",15),c(20,te,2,1,"div",12),n(),i(21,"div",16)(22,"a",17),a(23," Account "),d(24,"br"),a(25," Registration"),n(),i(26,"a",18),a(27," Forgote "),d(28,"br"),a(29," Password "),n()(),i(30,"button",19),a(31,"Login"),n()()()()(),c(32,ie,2,0,"div",20)(33,ne,9,0,"div",21)(34,oe,11,1,"div",22)),o&2&&(l(10),s("formGroup",r.adminform),l(5),s("ngIf",r.f.Email.touched&&r.f.Email.invalid),l(5),s("ngIf",r.f.password.touched&&r.f.password.invalid),l(12),s("ngIf",r.isloading),l(),s("ngIf",r.showpopup),l(),s("ngIf",r.showErrorPopup))},dependencies:[z,H,K,F,R,V,q,D,N,O,I],styles:[".login-container[_ngcontent-%COMP%]{margin-top:20px;position:relative;z-index:2;display:flex;justify-content:center;align-items:center;height:100vh;background-color:#eae6e61b}.login-card[_ngcontent-%COMP%]{background-color:#f3faf9;padding:50px 60px;position:relative;border-radius:12px;box-shadow:0 0 12px #00000026;text-align:center;width:450px}h2[_ngcontent-%COMP%]{margin-bottom:25px;font-size:32px;font-weight:700;color:#000;font-family:Tahoma,Verdana,sans-serif}.login-card[_ngcontent-%COMP%]   .back-arrow[_ngcontent-%COMP%]{position:absolute;top:16px;left:20px;margin:0;font-size:24px;color:#000}.input-field[_ngcontent-%COMP%]{width:100%;padding:14px;margin-bottom:20px;border:1px solid #ddd;border-radius:6px;outline:none;font-size:16px;background-color:#3e3e3e}.password-container[_ngcontent-%COMP%]{position:relative}.toggle-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:14px;cursor:pointer;color:#ddd;background-color:#ddd}.links[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:25px;font-size:16px}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{flex:1;text-align:center;background-color:#3e3e3e;color:#fff;padding:6px 0;border-radius:4px;text-decoration:none;font-size:14px;margin:0 6px;transition:background-color .3s ease;max-height:50px}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#00000072;color:#000}.login-button[_ngcontent-%COMP%]{width:100%;padding:14px;background-color:#c73b34;border:none;border-radius:6px;color:#fff;font-size:18px;cursor:pointer}.login-button[_ngcontent-%COMP%]:hover{background-color:#ec271c}.back[_ngcontent-%COMP%]{position:relative;width:100%;height:100vh;overflow:hidden}.back[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;min-width:100%;min-height:100%;transform:translate(-50%,-50%);object-fit:cover;z-index:1}.popup-overlay[_ngcontent-%COMP%], .error-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#2e2e2e97;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:12px;box-shadow:0 0 12px #00000040;text-align:center;max-width:700px;width:90%}.popup-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:10px}.spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#151515bb;display:flex;justify-content:center;align-items:center;z-index:999}.spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:6px solid #ccc;border-top-color:#dc3545;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})}}return t})();export{ue as AdminLoginComponent};
